<!-- menu.html -->
<nav class="navbar">
  <div class="navbar-logo">VotoUni</div>

  <div class="navbar-search">
    <input type="text" placeholder="Buscar..." id="searchInput" data-i18n-placeholder="searchPlaceholder" />
    <button class="search-btn" id="btnBuscar">ğŸ”</button>
  </div>

  <ul class="navbar-links" id="navLinks">
    <li><a href="inicio2.html" data-i18n="navHome">Inicio</a></li>
    <li><a href="candidatos.html" data-i18n="navCandidates">Candidatos</a></li>
    <li><a href="votacion.html" data-i18n="navVote">Votar</a></li>
    <li><a href="resultados.html" data-i18n="navResults">Resultados</a></li>
    <li><a href="reseÃ±as.html" data-i18n="navReviews">ReseÃ±as</a></li>
    <li><a href="contacto.html" data-i18n="navContact">Contacto</a></li>
    <li><a href="inicio.html" data-i18n="navLogout" id="cerrarSesionUsuario">Cerrar SesiÃ³n</a></li>
  </ul>

  <!-- â¬‡ï¸ SELECTOR DE IDIOMA MEJORADO -->
  <select id="langSelect" class="lang-select">
    <option value="es">ğŸ‡ªğŸ‡¸ ES</option>
    <option value="en">ğŸ‡ºğŸ‡¸ EN</option>
    <option value="id">ğŸ‡®ğŸ‡© ID</option>
  </select>

  <div class="navbar-toggle" id="toggleMenuBtn">â˜°</div>
</nav>

<script>
/* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”  SISTEMA DE TRADUCCIONES  â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */
const translations = {
  es: {
    // NavegaciÃ³n
    navHome: "Inicio",
    navCandidates: "Candidatos", 
    navVote: "Votar",
    navResults: "Resultados",
    navReviews: "ReseÃ±as",
    navContact: "Contacto",
    navLogout: "Cerrar SesiÃ³n",
    searchPlaceholder: "Buscar...",
    
    // BÃºsqueda
    searchEmpty: "Escribe algo para buscar",
    searchNoResults: "No se encontraron resultados para:",
    searchResultsFor: "Resultados de bÃºsqueda para:",
    
    // PÃ¡ginas comunes
    loading: "Cargando...",
    error: "Error",
    success: "Ã‰xito"
  },
  en: {
    // Navigation
    navHome: "Home",
    navCandidates: "Candidates",
    navVote: "Vote", 
    navResults: "Results",
    navReviews: "Reviews",
    navContact: "Contact",
    navLogout: "Logout",
    searchPlaceholder: "Search...",
    
    // Search
    searchEmpty: "Type something to search",
    searchNoResults: "No results found for:",
    searchResultsFor: "Search results for:",
    
    // Common pages
    loading: "Loading...",
    error: "Error",
    success: "Success"
  },
  id: {
    // Navigasi
    navHome: "Beranda",
    navCandidates: "Kandidat",
    navVote: "Pilih",
    navResults: "Hasil",
    navReviews: "Ulasan", 
    navContact: "Kontak",
    navLogout: "Keluar",
    searchPlaceholder: "Cari...",
    
    // Pencarian
    searchEmpty: "Ketik sesuatu untuk mencari",
    searchNoResults: "Tidak ada hasil untuk:",
    searchResultsFor: "Hasil pencarian untuk:",
    
    // Halaman umum
    loading: "Memuat...",
    error: "Kesalahan",
    success: "Berhasil"
  }
};

/* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”  IDIOMA ACTUAL  â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */
let currentLang = localStorage.getItem("lang") || "es";

/* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”  APLICAR TRADUCCIÃ“N  â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */
function applyTranslations() {
  console.log("ğŸŒ Aplicando traducciÃ³n:", currentLang);
  
  // Traducir elementos con data-i18n
  document.querySelectorAll("[data-i18n]").forEach(el => {
    const key = el.getAttribute("data-i18n");
    if (translations[currentLang] && translations[currentLang][key]) {
      el.textContent = translations[currentLang][key];
    }
  });
  
  // Traducir placeholders
  document.querySelectorAll("[data-i18n-placeholder]").forEach(el => {
    const key = el.getAttribute("data-i18n-placeholder");
    if (translations[currentLang] && translations[currentLang][key]) {
      el.placeholder = translations[currentLang][key];
    }
  });
}

/* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”  MENÃš RESPONSIVE  â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */
function initMenuToggle() {
  const toggleBtn = document.getElementById("toggleMenuBtn");
  const navLinks = document.getElementById("navLinks");
  
  if (toggleBtn && navLinks) {
    toggleBtn.addEventListener("click", () => {
      navLinks.classList.toggle("active");
    });
    console.log("âœ… MenÃº responsive conectado");
  }
}

/* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”  SISTEMA DE BÃšSQUEDA MEJORADO  â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */
function performSearch() {
  const searchInput = document.getElementById("searchInput");
  
  if (!searchInput) {
    console.error("âŒ No se encontrÃ³ el campo de bÃºsqueda");
    alert("Error: Campo de bÃºsqueda no encontrado");
    return;
  }
  
  const query = searchInput.value.toLowerCase().trim();
  console.log("ğŸ” Valor de bÃºsqueda:", query);
  
  if (!query) {
    alert(translations[currentLang].searchEmpty);
    return;
  }
  
  console.log("ğŸ” Buscando:", query);
  
  // TÃ©rminos de bÃºsqueda multiidioma
  const searchTerms = {
    candidates: {
      es: ["candidato", "candidatos", "presidente", "vicepresidente", "lista", "listas", "ana", "luis", "camila", "roberto"],
      en: ["candidate", "candidates", "president", "vice president", "list", "lists", "ana", "luis", "camila", "roberto"],
      id: ["kandidat", "presiden", "wakil presiden", "daftar", "ana", "luis", "camila", "roberto"]
    },
    vote: {
      es: ["votar", "votaciÃ³n", "voto", "votos", "elegir", "elecciÃ³n", "sufragio"],
      en: ["vote", "voting", "election", "choose", "ballot", "poll"],
      id: ["pilih", "pemilihan", "suara", "memilih", "voting"]
    },
    results: {
      es: ["resultado", "resultados", "ganador", "conteo", "estadÃ­stica", "estadisticas"],
      en: ["result", "results", "winner", "count", "statistics", "stats"],
      id: ["hasil", "pemenang", "perhitungan", "statistik"]
    },
    home: {
      es: ["inicio", "principal", "casa", "hogar", "bienvenida", "bienvenido"],
      en: ["home", "main", "start", "beginning", "welcome"],
      id: ["beranda", "utama", "awal", "selamat datang"]
    },
    reviews: {
      es: ["reseÃ±a", "reseÃ±as", "opiniÃ³n", "opiniones", "experiencia", "comentario", "valoraciÃ³n"],
      en: ["review", "reviews", "opinion", "opinions", "experience", "comment", "rating"],
      id: ["ulasan", "pendapat", "pengalaman", "komentar", "penilaian"]
    },
    contact: {
      es: ["contacto", "contactar", "mensaje", "comunicar", "ayuda", "soporte"],
      en: ["contact", "message", "communicate", "reach", "help", "support"],
      id: ["kontak", "pesan", "berkomunikasi", "bantuan", "dukungan"]
    }
  };
  
  // Buscar coincidencias
  let destination = null;
  let matchedTerm = "";
  
  for (const [page, terms] of Object.entries(searchTerms)) {
    const allTerms = Object.values(terms).flat();
    const matchedTermFound = allTerms.find(term => query.includes(term));
    
    if (matchedTermFound) {
      matchedTerm = matchedTermFound;
      switch (page) {
        case 'candidates': destination = 'candidatos.html'; break;
        case 'vote': destination = 'votacion.html'; break;
        case 'results': destination = 'resultados.html'; break;
        case 'home': destination = 'inicio2.html'; break;
        case 'reviews': destination = 'reseÃ±as.html'; break;
        case 'contact': destination = 'contacto.html'; break;
      }
      break;
    }
  }
  
  console.log("ğŸ¯ TÃ©rmino encontrado:", matchedTerm);
  console.log("ğŸ“ Destino:", destination);
  
  if (destination) {
    console.log("âœ… Redirigiendo a:", destination);
    // Mostrar mensaje antes de redirigir
    searchInput.value = "";  // Limpiar campo
    alert(`Redirigiendo a: ${matchedTerm} â†’ ${destination}`);
    setTimeout(() => {
      window.location.href = destination;
    }, 1000);
  } else {
    alert(`${translations[currentLang].searchNoResults} "${query}"`);
    console.log("âŒ No se encontraron coincidencias para:", query);
  }
}

// Eventos de bÃºsqueda - Con verificaciÃ³n de elementos
function initSearchEvents() {
  const btnBuscar = document.getElementById("btnBuscar");
  const searchInput = document.getElementById("searchInput");
  
  if (btnBuscar) {
    btnBuscar.addEventListener("click", e => {
      e.preventDefault();
      performSearch();
    });
    console.log("âœ… BotÃ³n de bÃºsqueda conectado");
  }

  if (searchInput) {
    searchInput.addEventListener("keypress", e => {
      if (e.key === "Enter") {
        e.preventDefault();
        performSearch();
      }
    });
    console.log("âœ… Campo de bÃºsqueda conectado");
  }
}

/* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”  SELECTOR DE IDIOMA  â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */
function initLanguageSelector() {
  const langSelect = document.getElementById("langSelect");
  
  if (langSelect) {
    langSelect.addEventListener("change", e => {
      const newLang = e.target.value;
      console.log("ğŸ”„ Cambiando idioma a:", newLang);
      
      localStorage.setItem("lang", newLang);
      currentLang = newLang;
      
      // Aplicar traducciÃ³n inmediatamente
      applyTranslations();
      
      // Opcional: recargar la pÃ¡gina para aplicar todas las traducciones
      setTimeout(() => {
        location.reload();
      }, 500);
    });
    console.log("âœ… Selector de idioma conectado");
  }
}

/* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”  CERRAR SESIÃ“N  â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */
function initLogout() {
  const logoutBtn = document.getElementById("cerrarSesionUsuario");
  
  if (logoutBtn) {
    logoutBtn.addEventListener("click", e => {
      e.preventDefault();
      localStorage.removeItem("rolUsuario");
      localStorage.removeItem("usuarioActual");
      window.location.href = "inicio.html";
    });
    console.log("âœ… BotÃ³n cerrar sesiÃ³n conectado");
  }
}

/* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”  INICIALIZACIÃ“N  â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */
document.addEventListener("DOMContentLoaded", () => {
  console.log("ğŸš€ Inicializando menÃº...");
  
  // Establecer idioma en el selector
  const langSelect = document.getElementById("langSelect");
  if (langSelect) {
    langSelect.value = currentLang;
  }
  
  // Aplicar traducciones
  applyTranslations();
  
  // Inicializar todos los eventos
  initMenuToggle();
  initSearchEvents();
  initLanguageSelector();
  initLogout();
  
  console.log("âœ… MenÃº inicializado con idioma:", currentLang);
});

// Aplicar traducciones inmediatamente
applyTranslations();

// TambiÃ©n inicializar eventos inmediatamente por si el DOM ya estÃ¡ listo
setTimeout(() => {
  initMenuToggle();
  initSearchEvents();
  initLanguageSelector(); 
  initLogout();
}, 100);
</script>
